{:theorem
 {:id :theorem,
  :statement
  "\\mathbb{E}_{w \\sim Q}[h(w)] \\leq \\frac{\\mathrm{KL}(Q \\| P) + \\ln \\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]}{\\beta}",
  :content-hash "d789c7751a5c211a"},
 :obligations [],
 :archived-nodes {},
 :external-refs {},
 :nodes
 {:2-c00002
  {:statement
   "$\\tilde{P}$ is a valid probability distribution since $\\int \\tilde{P}(w) dw = \\frac{\\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]}{\\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]} = 1$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "853ed3fa84468117",
   :display-order 13,
   :type :claim,
   :scope #{},
   :justification :algebraic-rewrite,
   :status :proposed,
   :id :2-c00002,
   :provenance
   {:created-at "2026-01-05T10:45:22.077191Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00001}},
  :2-c00001
  {:statement
   "Let $\\tilde{P}$ be the tilted distribution defined by $\\tilde{P}(w) = \\frac{e^{\\beta h(w)} P(w)}{\\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]}$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "e6db567217ca84f1",
   :display-order 12,
   :type :assumption,
   :scope #{},
   :justification :assumption,
   :status :proposed,
   :id :2-c00001,
   :provenance
   {:created-at "2026-01-05T10:45:13.732094Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{}},
  :1-b00007
  {:statement
   "$\\mathrm{KL}(Q \\| P) = \\mathbb{E}_{w \\sim Q}\\left[\\ln \\frac{Q(w)}{P(w)}\\right] = \\mathbb{E}_{w \\sim Q}\\left[\\ln \\frac{1}{P(\\mathcal{S})}\\right] = \\ln \\frac{1}{P(\\mathcal{S})}$",
   :taint :clean,
   :parent nil,
   :content-hash "1bd0575628985111",
   :display-order 7,
   :type :claim,
   :scope #{},
   :justification :algebraic-rewrite,
   :status :proposed,
   :id :1-b00007,
   :provenance
   {:created-at "2026-01-05T10:35:57.638681Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00006}},
  :2-c00003
  {:statement
   "By non-negativity of KL divergence: $\\mathrm{KL}(Q \\| \\tilde{P}) \\geq 0$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "02a25006c5872df6",
   :display-order 14,
   :type :claim,
   :scope #{},
   :justification :external-application,
   :status :proposed,
   :id :2-c00003,
   :provenance
   {:created-at "2026-01-05T10:45:54.551897Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00002}},
  :2-c00004
  {:statement
   "Expanding the KL divergence: $\\mathrm{KL}(Q \\| \\tilde{P}) = \\mathbb{E}_{w \\sim Q}\\left[\\ln \\frac{Q(w)}{\\tilde{P}(w)}\\right] = \\mathbb{E}_{w \\sim Q}\\left[\\ln Q(w) - \\ln \\tilde{P}(w)\\right]$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "94410717f1741ae1",
   :display-order 15,
   :type :claim,
   :scope #{},
   :justification :definition-expansion,
   :status :proposed,
   :id :2-c00004,
   :provenance
   {:created-at "2026-01-05T10:46:03.089087Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00003}},
  :2-c00008
  {:statement
   "Rearranging: $\\beta \\mathbb{E}_{w \\sim Q}[h(w)] \\leq \\mathrm{KL}(Q \\| P) + \\ln Z$, hence $\\mathbb{E}_{w \\sim Q}[h(w)] \\leq \\frac{\\mathrm{KL}(Q \\| P) + \\ln \\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]}{\\beta}$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "db426021ea34d4f3",
   :display-order 19,
   :type :claim,
   :scope #{},
   :justification :algebraic-rewrite,
   :status :proposed,
   :id :2-c00008,
   :provenance
   {:created-at "2026-01-05T10:46:37.877897Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00007}},
  :1-b00002
  {:statement
   "Let $Q$ be the posterior distribution, defined as $P$ restricted to the set of solutions $\\mathcal{S} = \\{w : \\text{train error}(w) = 0\\}$",
   :taint :clean,
   :parent nil,
   :content-hash "c88213e0211d7094",
   :display-order 2,
   :type :assumption,
   :scope #{},
   :justification :assumption,
   :status :proposed,
   :id :1-b00002,
   :provenance
   {:created-at "2026-01-05T10:35:00.596013Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{}},
  :1-b00003
  {:statement
   "Let $h(w)$ denote the generalization error (population loss) of weight vector $w$",
   :taint :clean,
   :parent nil,
   :content-hash "f8f3434a9d502b2f",
   :display-order 3,
   :type :assumption,
   :scope #{},
   :justification :assumption,
   :status :proposed,
   :id :1-b00003,
   :provenance
   {:created-at "2026-01-05T10:35:09.531770Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{}},
  :2-c00005
  {:statement
   "Substituting $\\tilde{P}(w) = \\frac{e^{\\beta h(w)} P(w)}{Z}$ where $Z = \\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]$: $\\ln \\tilde{P}(w) = \\beta h(w) + \\ln P(w) - \\ln Z$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "2dac962756f88727",
   :display-order 16,
   :type :claim,
   :scope #{},
   :justification :substitution,
   :status :proposed,
   :id :2-c00005,
   :provenance
   {:created-at "2026-01-05T10:46:12.052118Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00001 :2-c00004}},
  :1-b00004
  {:statement
   "Let $\\beta = m - 1$ where $m$ is the number of training points",
   :taint :clean,
   :parent nil,
   :content-hash "3d7123a1c25bc63d",
   :display-order 4,
   :type :assumption,
   :scope #{},
   :justification :assumption,
   :status :proposed,
   :id :1-b00004,
   :provenance
   {:created-at "2026-01-05T10:35:19.254072Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{}},
  :2-c00007
  {:statement
   "From $\\mathrm{KL}(Q \\| \\tilde{P}) \\geq 0$: $\\mathrm{KL}(Q \\| P) - \\beta \\mathbb{E}_{w \\sim Q}[h(w)] + \\ln Z \\geq 0$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "2f0a3a75685fc894",
   :display-order 18,
   :type :claim,
   :scope #{},
   :justification :modus-ponens,
   :status :proposed,
   :id :2-c00007,
   :provenance
   {:created-at "2026-01-05T10:46:28.641095Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00003 :2-c00006}},
  :1-b00009
  {:statement
   "For $w \\in \\text{supp}(Q) = \\mathcal{S}$, the training error is 0, so $h(w)$ measures the population (generalization) error directly",
   :taint :clean,
   :parent nil,
   :content-hash "34a4bb74bb1fb090",
   :display-order 9,
   :type :claim,
   :scope #{},
   :justification :modus-ponens,
   :status :proposed,
   :id :1-b00009,
   :provenance
   {:created-at "2026-01-05T10:36:16.500286Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00002 :1-b00003}},
  :1-b00008
  {:statement
   "$P(\\mathcal{S})$ is the prior probability of all solutions, i.e., the evidence. Thus $\\mathrm{KL}(Q \\| P) = \\ln \\frac{1}{\\text{evidence}}$",
   :taint :clean,
   :parent nil,
   :content-hash "dc8e7f47cf628310",
   :display-order 8,
   :type :claim,
   :scope #{},
   :justification :definition-expansion,
   :status :proposed,
   :id :1-b00008,
   :provenance
   {:created-at "2026-01-05T10:36:06.609354Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00007}},
  :1-b00005
  {:statement
   "PAC-Bayes Theorem (McAllester, 1999): For any prior $P$, posterior $Q$, and $\\beta > 0$: $\\mathbb{E}_{w \\sim Q}[h(w)] \\leq \\frac{\\mathrm{KL}(Q \\| P) + \\ln \\mathbb{E}_{w \\sim P}[e^{\\beta h(w)}]}{\\beta}$",
   :taint :clean,
   :parent nil,
   :content-hash "a8a116db0cf82376",
   :display-order 5,
   :type :claim,
   :scope #{},
   :justification :admitted,
   :status :verified,
   :id :1-b00005,
   :provenance
   {:created-at "2026-01-05T10:35:38.849835Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{}},
  :1-b00006
  {:statement
   "Since $Q$ is $P$ restricted to solutions $\\mathcal{S}$, we have $Q(w) = \\frac{P(w)}{P(\\mathcal{S})}$ for $w \\in \\mathcal{S}$ and $Q(w) = 0$ otherwise",
   :taint :clean,
   :parent nil,
   :content-hash "334fe81d51b01181",
   :display-order 6,
   :type :claim,
   :scope #{},
   :justification :definition-expansion,
   :status :proposed,
   :id :1-b00006,
   :provenance
   {:created-at "2026-01-05T10:35:48.551046Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00002 :1-b00001}},
  :1-b00001
  {:statement
   "Let $P$ be a prior distribution on the weight space $\\mathcal{W}$",
   :taint :clean,
   :parent nil,
   :content-hash "0983f2dc133ac77b",
   :display-order 1,
   :type :assumption,
   :scope #{},
   :justification :assumption,
   :status :proposed,
   :id :1-b00001,
   :provenance
   {:created-at "2026-01-05T10:34:49.911709Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{}},
  :1-b00010
  {:statement
   "Applying the PAC-Bayes theorem with our setup: $\\mathbb{E}_{w \\sim Q}[h(w)] \\leq \\frac{\\ln(1/\\text{evidence}) + \\ln \\mathbb{E}_{w \\sim P}[e^{(m-1) h(w)}]}{m-1}$",
   :taint :clean,
   :parent nil,
   :content-hash "0f33d0117cd5d5d8",
   :display-order 10,
   :type :claim,
   :scope #{},
   :justification :substitution,
   :status :proposed,
   :id :1-b00010,
   :provenance
   {:created-at "2026-01-05T10:36:25.413961Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00004 :1-b00008 :1-b00005}},
  :1-b00011
  {:statement
   "The expected generalization error over solutions is bounded by the sum of log-inverse-evidence and the log-moment-generating-function of the loss under the prior, normalized by $\\beta = m-1$",
   :taint :clean,
   :parent nil,
   :content-hash "4c391e0decc7158f",
   :display-order 11,
   :type :qed,
   :scope #{},
   :justification :qed,
   :status :proposed,
   :id :1-b00011,
   :provenance
   {:created-at "2026-01-05T10:36:34.809737Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 1,
   :dependencies #{:1-b00009 :1-b00010}},
  :2-c00006
  {:statement
   "Therefore: $\\mathrm{KL}(Q \\| \\tilde{P}) = \\mathbb{E}_{w \\sim Q}[\\ln Q(w) - \\beta h(w) - \\ln P(w) + \\ln Z] = \\mathrm{KL}(Q \\| P) - \\beta \\mathbb{E}_{w \\sim Q}[h(w)] + \\ln Z$",
   :taint :clean,
   :parent :1-b00005,
   :content-hash "7871de4f7ba48bce",
   :display-order 17,
   :type :claim,
   :scope #{},
   :justification :algebraic-rewrite,
   :status :proposed,
   :id :2-c00006,
   :provenance
   {:created-at "2026-01-05T10:46:20.975485Z",
    :created-by :prover,
    :round 0,
    :revision-of nil},
   :depth 2,
   :dependencies #{:2-c00004 :2-c00005}}},
 :graph-id "graph-18d478-4253a9",
 :version 21,
 :lemmas {},
 :metadata
 {:created-at "2026-01-05T10:34:37.088141Z",
  :last-modified "2026-01-05T10:46:46.990632Z",
  :proof-mode :strict-mathematics,
  :iteration-counts {:verification {}, :expansion {}, :strategy 0},
  :context-budget {:max-tokens 100000, :current-estimate 2120}},
 :symbols {}}
