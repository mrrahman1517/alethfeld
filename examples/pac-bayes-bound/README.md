# Proof: PAC-Bayes Generalization Bound

A **fully self-contained** derivation of the PAC-Bayes bound on expected generalization error. This proof includes the core Gibbs variational inequality (Donsker-Varadhan) derived from first principles.

## Files

- `pac-bayes-bound.edn` — Semantic proof graph (Alethfeld format)
- `pac-bayes-bound.tex` — LaTeX document with Lamport-style formatting
- `pac_bayes_bound.pdf` — Compiled PDF

## Theorem

For prior P, posterior Q (P restricted to zero-training-error solutions), and β = m-1:

$$\mathbb{E}_{w \sim Q}[h(w)] \leq \frac{\mathrm{KL}(Q \| P) + \ln \mathbb{E}_{w \sim P}[e^{\beta h(w)}]}{\beta}$$

## Key Results

### Lemma: Gibbs Variational Inequality (Donsker-Varadhan)

**Proved from first principles** using only non-negativity of KL divergence:

1. Define tilted distribution: $\tilde{P}(w) = \frac{e^{\beta h(w)} P(w)}{Z}$
2. Use $\mathrm{KL}(Q \| \tilde{P}) \geq 0$
3. Expand and rearrange to obtain the bound

### Main Theorem Application

When Q is P restricted to the solution set S:

$$\mathrm{KL}(Q \| P) = \ln \frac{1}{P(S)} = \ln \frac{1}{\text{evidence}}$$

## Proof Strategy

### Lemma (8 steps):
1. Define tilted measure P̃
2. Verify P̃ is a valid distribution
3. Apply KL(Q||P̃) ≥ 0
4. Expand KL divergence definition
5. Substitute P̃ definition
6. Simplify to KL(Q||P) - βE[h] + ln Z
7. Apply non-negativity
8. Rearrange to get bound

### Main Theorem (11 steps):
1. Setup: Define P (prior), Q (posterior), h(w), β = m-1
2. Apply Gibbs lemma (**verified, not admitted**)
3. Compute KL(Q||P) = log(1/evidence)
4. Conclude the bound

## Graph Statistics

| Metric | Value |
|--------|-------|
| Total nodes | 19 |
| Assumptions | 5 |
| Claims | 13 |
| QED | 1 |
| Verified | 1 (Gibbs lemma) |
| Admitted | 0 |
| **Taint** | **Clean** ✓ |

## References

- Donsker, M. D. & Varadhan, S. R. S. (1975). Asymptotic evaluation of certain Markov process expectations.
- McAllester, D. A. (1999). PAC-Bayesian model averaging. *COLT*.
- Catoni, O. (2007). PAC-Bayesian Supervised Classification. *IMS Lecture Notes*.

## Usage

```bash
# Validate the proof graph
cd cli
./scripts/alethfeld validate ../examples/pac-bayes-bound/pac-bayes-bound.edn

# View statistics  
./scripts/alethfeld stats ../examples/pac-bayes-bound/pac-bayes-bound.edn
```

## Compiling LaTeX

```bash
cd examples/pac-bayes-bound
pdflatex pac-bayes-bound.tex
```

## Source

Derived from informal specification showing the connection between PAC-Bayes bounds and Bayesian evidence. The Gibbs variational inequality was proved to make the proof fully self-contained.

## Generated By

Alethfeld Proof Orchestrator v5.1 — January 2026
